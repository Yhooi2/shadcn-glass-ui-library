import { Meta, Canvas, ArgTypes, Source, Controls } from '@storybook/blocks';
import * as InputGlassStories from '../../src/components/InputGlass.stories';

<Meta of={InputGlassStories} />

# InputGlass

Glassmorphism text input component with validation states, icons, and full accessibility support.

## Features

- ‚ú® **Multiple States** - default, error, success, disabled
- üé® **Icon Support** - Left and right icon slots
- üì± **iOS Safe** - Minimum 16px font size (prevents auto-zoom)
- ‚ôø **WCAG 2.1 AA** - Proper labels, ARIA attributes
- üéØ **Touch Targets** - Minimum 40-44px height
- üîí **Type Safety** - Full TypeScript support

## Installation

```bash
npx shadcn@latest add @shadcn-glass-ui/input
```

Or manually copy:
```tsx
import { InputGlass } from '@/components/glass/ui/input-glass';
```

## Usage

### Basic Example

<Canvas of={InputGlassStories.Default} />

```tsx
import { InputGlass } from '@/components/glass/ui/input-glass';

export default function Demo() {
  return (
    <InputGlass
      label="Email"
      placeholder="Enter your email..."
      type="email"
    />
  );
}
```

## API Reference

<ArgTypes of={InputGlassStories} />

<Controls of={InputGlassStories.Default} />

## Design Tokens

| Token | Value | Notes |
|-------|-------|-------|
| **Font Size** | 16px (base) | iOS minimum to prevent auto-zoom |
| **Min Height** | 40-44px | Apple HIG touch target |
| **Border Radius** | 12px (md), 16px (lg) | Matches button sizes |
| **Padding** | 16px horizontal | Comfortable text spacing |
| **Focus Ring** | 2px violet-500 | WCAG 2.1 AA compliant |

### Size Specifications

| Size | Height | Padding | Font Size | Use Case |
|------|--------|---------|-----------|----------|
| `sm` | 40px | 12px / 8px | 16px | Compact forms |
| `md` | 44px | 16px / 10px | 16px | Default forms |
| `lg` | 48px | 20px / 12px | 16px-18px | Prominent inputs |

## Validation States

### Error State

<Canvas of={InputGlassStories.WithError} />

```tsx
<InputGlass
  label="Email"
  error="Invalid email address"
  value="invalid@"
/>
```

### Success State

<Canvas of={InputGlassStories.WithSuccess} />

```tsx
<InputGlass
  label="Email"
  success="Email verified"
  value="user@example.com"
/>
```

### Disabled State

<Canvas of={InputGlassStories.Disabled} />

```tsx
<InputGlass
  label="Username"
  disabled
  value="john_doe"
/>
```

## Icons

### Left Icon

<Canvas of={InputGlassStories.WithLeftIcon} />

```tsx
import { Mail } from 'lucide-react';

<InputGlass
  label="Email"
  leftIcon={<Mail className="w-4 h-4" />}
  placeholder="email@example.com"
/>
```

### Right Icon

<Canvas of={InputGlassStories.WithRightIcon} />

```tsx
import { Eye } from 'lucide-react';

<InputGlass
  label="Password"
  type="password"
  rightIcon={<Eye className="w-4 h-4" />}
/>
```

### Both Icons

```tsx
import { Search, Filter } from 'lucide-react';

<InputGlass
  placeholder="Search..."
  leftIcon={<Search className="w-4 h-4" />}
  rightIcon={<Filter className="w-4 h-4" />}
/>
```

## Input Types

### Text Input

```tsx
<InputGlass
  label="Full Name"
  type="text"
  placeholder="John Doe"
/>
```

### Email Input

```tsx
<InputGlass
  label="Email Address"
  type="email"
  placeholder="user@example.com"
  autoComplete="email"
/>
```

### Password Input

```tsx
<InputGlass
  label="Password"
  type="password"
  autoComplete="new-password"
/>
```

### Number Input

```tsx
<InputGlass
  label="Age"
  type="number"
  min={0}
  max={120}
/>
```

### Search Input

```tsx
import { Search } from 'lucide-react';

<InputGlass
  type="search"
  placeholder="Search..."
  leftIcon={<Search className="w-4 h-4" />}
/>
```

## Accessibility

### Labels and ARIA

All inputs should have proper labels:

```tsx
// Visible label (preferred)
<InputGlass
  label="Email"
  id="email-input"
/>

// Hidden label (use only when visually obvious)
<InputGlass
  aria-label="Search products"
  placeholder="Search..."
/>
```

### Error Announcements

Error messages are announced to screen readers:

```tsx
<InputGlass
  label="Email"
  error="Please enter a valid email"
  aria-invalid="true"
  aria-describedby="email-error"
/>
```

### Required Fields

```tsx
<InputGlass
  label="Email"
  required
  aria-required="true"
/>
```

## Form Integration

### Controlled Input

```tsx
import { useState } from 'react';

function LoginForm() {
  const [email, setEmail] = useState('');

  return (
    <InputGlass
      label="Email"
      value={email}
      onChange={(e) => setEmail(e.target.value)}
    />
  );
}
```

### Form Validation

```tsx
import { useState } from 'react';

function SignupForm() {
  const [email, setEmail] = useState('');
  const [error, setError] = useState('');

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const value = e.target.value;
    setEmail(value);

    if (!value.includes('@')) {
      setError('Invalid email address');
    } else {
      setError('');
    }
  };

  return (
    <InputGlass
      label="Email"
      value={email}
      onChange={handleChange}
      error={error}
    />
  );
}
```

### React Hook Form

```tsx
import { useForm } from 'react-hook-form';

function ContactForm() {
  const { register, formState: { errors } } = useForm();

  return (
    <InputGlass
      label="Email"
      {...register('email', {
        required: 'Email is required',
        pattern: {
          value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,
          message: 'Invalid email address'
        }
      })}
      error={errors.email?.message}
    />
  );
}
```

## Theme Support

InputGlass adapts to all three themes:

```tsx
// Glass theme (dark)
<div className="theme-glass">
  <InputGlass label="Username" />
</div>

// Light theme
<div className="theme-light">
  <InputGlass label="Username" />
</div>

// Aurora theme (gradient)
<div className="theme-aurora">
  <InputGlass label="Username" />
</div>
```

## Best Practices

### ‚úÖ Do

- Always provide a visible label or `aria-label`
- Use `type="email"` for email inputs
- Use `autoComplete` attributes for better UX
- Show clear error messages below the input
- Use placeholder text for format examples only
- Maintain 16px minimum font size for mobile

### ‚ùå Don't

- Don't use placeholder as a label replacement
- Don't use font-size < 16px (causes iOS zoom)
- Don't disable spellcheck on name/address fields
- Don't use vague error messages
- Don't override browser autofill styling

## iOS Considerations

**Critical:** InputGlass uses `text-base` (16px) to prevent iOS Safari from auto-zooming when the input is focused. This is a strict requirement per Apple's guidelines.

```tsx
// ‚úÖ Correct - 16px minimum
<InputGlass className="text-base" />

// ‚ùå Wrong - Will trigger zoom on iOS
<InputGlass className="text-sm" />
```

## Examples

### Login Form

```tsx
import { Mail, Lock } from 'lucide-react';

<form className="space-y-4">
  <InputGlass
    label="Email"
    type="email"
    leftIcon={<Mail className="w-4 h-4" />}
    autoComplete="email"
  />

  <InputGlass
    label="Password"
    type="password"
    leftIcon={<Lock className="w-4 h-4" />}
    autoComplete="current-password"
  />
</form>
```

### Search Bar

```tsx
import { Search } from 'lucide-react';

<InputGlass
  type="search"
  placeholder="Search products..."
  leftIcon={<Search className="w-4 h-4" />}
  className="w-full max-w-md"
/>
```

## Related Components

- [ButtonGlass](/?path=/docs/components-buttonglass--docs) - Submit buttons
- [CheckboxGlass](/?path=/docs/components-checkboxglass--docs) - Checkbox input
- [DropdownGlass](/?path=/docs/components-dropdownglass--docs) - Select dropdown

## Technical Implementation

Built with:
- **Native HTML Input** - Standard `<input>` element
- **Tailwind CSS** - Utility-first styling
- **TypeScript** - Full type safety
- **CVA** - Variant management

View source: [input-glass.tsx](https://github.com/yourusername/shadcn-glass-ui/blob/main/src/components/glass/ui/input-glass.tsx)
