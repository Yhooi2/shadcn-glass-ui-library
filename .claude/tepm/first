// ========================================
// GLASS THEME FIXES - 4 Components
// Copy these to replace the broken ones
// ========================================

// Glass theme specific styles (add to themeStyles.glass)
const glassThemeAdditions = {
  // Notifications - more glassy
  notificationBg: 'rgba(255,255,255,0.08)',
  notificationBorder: 'rgba(255,255,255,0.15)',
  notificationGlow: '0 8px 32px rgba(168,85,247,0.20), inset 0 1px 0 rgba(255,255,255,0.10)',
  notificationIconBg: 'rgba(255,255,255,0.10)',

  // Avatar - purple glow instead of yellow
  avatarStatusGlow: 'rgba(168,85,247,0.60)',
  avatarStatusBorder: 'rgba(15,23,42,0.80)',

  // Dropdown - glassy
  dropdownBg: 'rgba(255,255,255,0.08)',
  dropdownBorder: 'rgba(255,255,255,0.15)',
  dropdownGlow: '0 15px 50px rgba(168,85,247,0.25), inset 0 1px 0 rgba(255,255,255,0.10)',
  dropdownItemHover: 'rgba(255,255,255,0.12)',
  dropdownDivider: 'rgba(255,255,255,0.08)',

  // Modal - more transparent with glow
  modalBg: 'rgba(255,255,255,0.06)',
  modalBorder: 'rgba(255,255,255,0.12)',
  modalGlow: '0 25px 80px rgba(168,85,247,0.35), inset 0 1px 0 rgba(255,255,255,0.15)',
  modalOverlay: 'rgba(15,23,42,0.60)',
  modalCloseHover: 'rgba(255,255,255,0.15)',
};

// ========================================
// 1. NOTIFICATION COMPONENT - Fixed
// ========================================
const NotificationGlass = ({ type = 'info', title, message, onClose }) => {
  const [isHovered, setIsHovered] = useState(false);

  const types = {
    info: {
      icon: Info,
      color: '#60a5fa',
      iconBg: 'rgba(96,165,250,0.15)',
      glow: '0 0 20px rgba(96,165,250,0.30)',
    },
    success: {
      icon: CheckCircle,
      color: '#34d399',
      iconBg: 'rgba(52,211,153,0.15)',
      glow: '0 0 20px rgba(52,211,153,0.30)',
    },
    warning: {
      icon: AlertTriangle,
      color: '#fbbf24',
      iconBg: 'rgba(251,191,36,0.15)',
      glow: '0 0 20px rgba(251,191,36,0.30)',
    },
    error: {
      icon: AlertCircle,
      color: '#fb7185',
      iconBg: 'rgba(251,113,133,0.15)',
      glow: '0 0 20px rgba(251,113,133,0.30)',
    },
  };

  const config = types[type];
  const Icon = config.icon;

  return (
    <div
      className="flex items-start gap-4 p-5 rounded-2xl min-w-[320px] max-w-[420px] transition-all duration-300"
      style={{
        background: 'rgba(255,255,255,0.08)',
        border: '1px solid rgba(255,255,255,0.15)',
        boxShadow: isHovered
          ? `0 12px 40px rgba(168,85,247,0.30), inset 0 1px 0 rgba(255,255,255,0.15), ${config.glow}`
          : '0 8px 32px rgba(168,85,247,0.20), inset 0 1px 0 rgba(255,255,255,0.10)',
        backdropFilter: 'blur(20px)',
        WebkitBackdropFilter: 'blur(20px)',
        transform: isHovered ? 'translateY(-2px)' : 'translateY(0)',
      }}
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
    >
      {/* Icon with glow */}
      <div
        className="w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 transition-all duration-300"
        style={{
          background: config.iconBg,
          border: `1px solid ${config.color}30`,
          boxShadow: isHovered ? config.glow : 'none',
        }}
      >
        <Icon className="w-5 h-5" style={{ color: config.color }} />
      </div>

      {/* Content */}
      <div className="flex-1 min-w-0">
        <p className="font-semibold text-sm mb-1" style={{ color: 'rgba(255,255,255,0.95)' }}>
          {title}
        </p>
        <p className="text-sm leading-relaxed" style={{ color: 'rgba(255,255,255,0.60)' }}>
          {message}
        </p>
      </div>

      {/* Close button */}
      <button
        onClick={onClose}
        className="p-1.5 rounded-lg transition-all duration-300 flex-shrink-0"
        style={{
          color: 'rgba(255,255,255,0.40)',
          background: 'transparent',
        }}
        onMouseEnter={(e) => {
          e.currentTarget.style.background = 'rgba(255,255,255,0.10)';
          e.currentTarget.style.color = 'rgba(255,255,255,0.80)';
        }}
        onMouseLeave={(e) => {
          e.currentTarget.style.background = 'transparent';
          e.currentTarget.style.color = 'rgba(255,255,255,0.40)';
        }}
      >
        <X className="w-4 h-4" />
      </button>
    </div>
  );
};

// ========================================
// 2. AVATAR COMPONENT - Fixed Status Glow
// ========================================
const AvatarGlass = ({ name, size = 'md', status, className = '' }) => {
  const [isHovered, setIsHovered] = useState(false);

  const sizes = {
    sm: 'w-8 h-8 text-xs',
    md: 'w-10 h-10 text-sm',
    lg: 'w-12 h-12 text-base',
    xl: 'w-16 h-16 text-lg',
  };

  const statusSizes = {
    sm: 'w-2.5 h-2.5',
    md: 'w-3 h-3',
    lg: 'w-3.5 h-3.5',
    xl: 'w-4 h-4',
  };

  // Glass theme status colors - purple/violet tinted
  const statusColors = {
    online: {
      bg: '#34d399',
      glow: '0 0 8px rgba(52,211,153,0.60), 0 0 16px rgba(52,211,153,0.30)',
    },
    offline: {
      bg: 'rgba(255,255,255,0.30)',
      glow: 'none',
    },
    busy: {
      bg: '#fb7185',
      glow: '0 0 8px rgba(251,113,133,0.60), 0 0 16px rgba(251,113,133,0.30)',
    },
    away: {
      bg: '#fbbf24',
      glow: '0 0 8px rgba(251,191,36,0.60), 0 0 16px rgba(251,191,36,0.30)',
    },
  };

  const getInitials = (name) =>
    name
      ?.split(' ')
      .map((n) => n[0])
      .join('')
      .toUpperCase()
      .slice(0, 2) || '?';

  return (
    <div
      className={`relative inline-flex ${className}`}
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
    >
      {/* Avatar circle */}
      <div
        className={`${sizes[size]} rounded-full flex items-center justify-center font-semibold transition-all duration-300`}
        style={{
          background: 'linear-gradient(135deg, rgba(168,85,247,0.80), rgba(139,92,246,0.80))',
          border: '2px solid rgba(255,255,255,0.20)',
          boxShadow: isHovered
            ? '0 0 30px rgba(168,85,247,0.50), inset 0 1px 0 rgba(255,255,255,0.20)'
            : '0 4px 20px rgba(168,85,247,0.30)',
          color: '#ffffff',
          backdropFilter: 'blur(8px)',
        }}
      >
        {getInitials(name)}
      </div>

      {/* Status indicator - no border, just glow */}
      {status && (
        <span
          className={`absolute bottom-0 right-0 ${statusSizes[size]} rounded-full transition-all duration-300`}
          style={{
            background: statusColors[status].bg,
            boxShadow: statusColors[status].glow,
          }}
        />
      )}
    </div>
  );
};

// ========================================
// 3. DROPDOWN COMPONENT - Fixed Glass Style
// ========================================
const DropdownGlass = ({ trigger, items, align = 'left' }) => {
  const [isOpen, setIsOpen] = useState(false);
  const [hoveredItem, setHoveredItem] = useState(null);

  return (
    <div className="relative inline-block">
      <div onClick={() => setIsOpen(!isOpen)}>{trigger}</div>

      {isOpen && (
        <>
          {/* Backdrop */}
          <div className="fixed inset-0 z-40" onClick={() => setIsOpen(false)} />

          {/* Dropdown menu */}
          <div
            className={`absolute z-50 mt-2 min-w-[200px] rounded-2xl py-2 transition-all duration-300
              ${align === 'right' ? 'right-0' : 'left-0'}`}
            style={{
              background: 'rgba(255,255,255,0.08)',
              border: '1px solid rgba(255,255,255,0.15)',
              boxShadow: '0 15px 50px rgba(168,85,247,0.25), inset 0 1px 0 rgba(255,255,255,0.10)',
              backdropFilter: 'blur(20px)',
              WebkitBackdropFilter: 'blur(20px)',
              animation: 'dropdownFadeIn 0.2s ease-out',
            }}
          >
            {items.map((item, idx) =>
              item.divider ? (
                <div
                  key={idx}
                  className="my-2 mx-3"
                  style={{ borderTop: '1px solid rgba(255,255,255,0.08)' }}
                />
              ) : (
                <button
                  key={idx}
                  onClick={() => {
                    item.onClick?.();
                    setIsOpen(false);
                  }}
                  className="w-full px-4 py-2.5 text-sm text-left flex items-center gap-3 transition-all duration-200 mx-0"
                  style={{
                    color: item.danger ? '#fb7185' : 'rgba(255,255,255,0.80)',
                    background: hoveredItem === idx ? 'rgba(255,255,255,0.10)' : 'transparent',
                  }}
                  onMouseEnter={() => setHoveredItem(idx)}
                  onMouseLeave={() => setHoveredItem(null)}
                >
                  {item.icon && (
                    <item.icon
                      className="w-4 h-4 transition-all duration-200"
                      style={{
                        color: item.danger
                          ? '#fb7185'
                          : hoveredItem === idx
                            ? '#c4b5fd'
                            : 'rgba(255,255,255,0.50)',
                      }}
                    />
                  )}
                  <span className="font-medium">{item.label}</span>
                </button>
              )
            )}
          </div>
        </>
      )}

      {/* Animation keyframes */}
      <style>{`
        @keyframes dropdownFadeIn {
          from {
            opacity: 0;
            transform: translateY(-8px) scale(0.96);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }
      `}</style>
    </div>
  );
};

// ========================================
// 4. MODAL COMPONENT - Fixed Glass Style
// ========================================
const ModalGlass = ({ isOpen, onClose, title, children, size = 'md' }) => {
  const [isClosing, setIsClosing] = useState(false);

  const sizes = {
    sm: 'max-w-sm',
    md: 'max-w-md',
    lg: 'max-w-lg',
    xl: 'max-w-xl',
    full: 'max-w-4xl',
  };

  const handleClose = () => {
    setIsClosing(true);
    setTimeout(() => {
      setIsClosing(false);
      onClose();
    }, 200);
  };

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
      {/* Overlay with blur */}
      <div
        className="absolute inset-0 transition-all duration-300"
        style={{
          background: 'rgba(15,23,42,0.60)',
          backdropFilter: 'blur(8px)',
          WebkitBackdropFilter: 'blur(8px)',
          opacity: isClosing ? 0 : 1,
        }}
        onClick={handleClose}
      />

      {/* Modal content */}
      <div
        className={`relative ${sizes[size]} w-full rounded-3xl p-6 transition-all duration-300`}
        style={{
          background: 'rgba(255,255,255,0.06)',
          border: '1px solid rgba(255,255,255,0.12)',
          boxShadow: '0 25px 80px rgba(168,85,247,0.35), inset 0 1px 0 rgba(255,255,255,0.15)',
          backdropFilter: 'blur(24px)',
          WebkitBackdropFilter: 'blur(24px)',
          transform: isClosing ? 'scale(0.95) translateY(10px)' : 'scale(1) translateY(0)',
          opacity: isClosing ? 0 : 1,
          animation: !isClosing ? 'modalFadeIn 0.3s ease-out' : 'none',
        }}
      >
        {/* Glow effect */}
        <div
          className="absolute inset-0 rounded-3xl pointer-events-none"
          style={{
            background:
              'radial-gradient(ellipse at top, rgba(168,85,247,0.15) 0%, transparent 50%)',
          }}
        />

        {/* Header */}
        <div className="relative flex items-center justify-between mb-5">
          <h3 className="text-xl font-semibold" style={{ color: 'rgba(255,255,255,0.95)' }}>
            {title}
          </h3>
          <button
            onClick={handleClose}
            className="p-2 rounded-xl transition-all duration-300"
            style={{
              background: 'rgba(255,255,255,0.08)',
              border: '1px solid rgba(255,255,255,0.10)',
              color: 'rgba(255,255,255,0.50)',
            }}
            onMouseEnter={(e) => {
              e.currentTarget.style.background = 'rgba(255,255,255,0.15)';
              e.currentTarget.style.color = 'rgba(255,255,255,0.90)';
              e.currentTarget.style.boxShadow = '0 0 20px rgba(168,85,247,0.30)';
            }}
            onMouseLeave={(e) => {
              e.currentTarget.style.background = 'rgba(255,255,255,0.08)';
              e.currentTarget.style.color = 'rgba(255,255,255,0.50)';
              e.currentTarget.style.boxShadow = 'none';
            }}
          >
            <X className="w-4 h-4" />
          </button>
        </div>

        {/* Content */}
        <div className="relative" style={{ color: 'rgba(255,255,255,0.70)' }}>
          {children}
        </div>
      </div>

      {/* Animation keyframes */}
      <style>{`
        @keyframes modalFadeIn {
          from {
            opacity: 0;
            transform: scale(0.95) translateY(20px);
          }
          to {
            opacity: 1;
            transform: scale(1) translateY(0);
          }
        }
      `}</style>
    </div>
  );
};

// ========================================
// USAGE EXAMPLE
// ========================================
const GlassFixesDemo = () => {
  const [modalOpen, setModalOpen] = useState(false);

  const dropdownItems = [
    { label: 'Profile', icon: User, onClick: () => {} },
    { label: 'Settings', icon: Settings, onClick: () => {} },
    { divider: true },
    { label: 'Sign out', icon: LogOut, danger: true, onClick: () => {} },
  ];

  return (
    <div
      className="min-h-screen p-8"
      style={{
        background: 'linear-gradient(135deg, #0f172a, #581c87, #0f172a)',
      }}
    >
      {/* Orbs */}
      <div className="fixed inset-0 overflow-hidden pointer-events-none">
        <div
          className="absolute top-20 -left-20 w-80 h-80 rounded-full blur-3xl"
          style={{ background: 'rgba(168,85,247,0.30)' }}
        />
        <div
          className="absolute bottom-20 -right-20 w-96 h-96 rounded-full blur-3xl"
          style={{ background: 'rgba(59,130,246,0.20)' }}
        />
      </div>

      <div className="relative z-10 max-w-2xl mx-auto space-y-8">
        <h1 className="text-3xl font-bold text-white mb-8">Glass Theme Fixes</h1>

        {/* 1. Notifications */}
        <section>
          <h2 className="text-lg font-semibold text-white/80 mb-4">Notifications</h2>
          <div className="space-y-3">
            <NotificationGlass
              type="info"
              title="New update available"
              message="Version 2.0 is ready to install"
              onClose={() => {}}
            />
            <NotificationGlass
              type="success"
              title="Payment successful"
              message="Your payment has been processed"
              onClose={() => {}}
            />
          </div>
        </section>

        {/* 2. Avatars */}
        <section>
          <h2 className="text-lg font-semibold text-white/80 mb-4">Avatars with Status</h2>
          <div className="flex items-center gap-6">
            <AvatarGlass name="John Doe" size="sm" status="online" />
            <AvatarGlass name="Jane Smith" size="md" status="online" />
            <AvatarGlass name="Bob Johnson" size="lg" status="busy" />
            <AvatarGlass name="Alice Brown" size="xl" status="away" />
          </div>
        </section>

        {/* 3. Dropdown */}
        <section>
          <h2 className="text-lg font-semibold text-white/80 mb-4">Dropdown</h2>
          <DropdownGlass
            trigger={
              <button
                className="px-5 py-2.5 rounded-xl font-medium flex items-center gap-2 transition-all duration-300"
                style={{
                  background: 'rgba(255,255,255,0.10)',
                  border: '1px solid rgba(255,255,255,0.20)',
                  color: 'rgba(255,255,255,0.90)',
                }}
              >
                Dropdown
                <ChevronDown className="w-4 h-4" />
              </button>
            }
            items={dropdownItems}
          />
        </section>

        {/* 4. Modal */}
        <section>
          <h2 className="text-lg font-semibold text-white/80 mb-4">Modal</h2>
          <button
            onClick={() => setModalOpen(true)}
            className="px-5 py-2.5 rounded-xl font-medium transition-all duration-300"
            style={{
              background: 'linear-gradient(135deg, #a855f7, #8b5cf6)',
              color: '#ffffff',
              boxShadow: '0 4px 20px rgba(168,85,247,0.40)',
            }}
          >
            Open Modal
          </button>

          <ModalGlass
            isOpen={modalOpen}
            onClose={() => setModalOpen(false)}
            title="Modal Title"
            size="md"
          >
            <p className="mb-6 leading-relaxed">
              This is a modal dialog with glassmorphism styling. It adapts to all three themes
              automatically.
            </p>
            <div className="flex gap-3 justify-end">
              <button
                onClick={() => setModalOpen(false)}
                className="px-5 py-2.5 rounded-xl font-medium transition-all duration-300"
                style={{
                  background: 'transparent',
                  color: 'rgba(255,255,255,0.70)',
                }}
              >
                Cancel
              </button>
              <button
                onClick={() => setModalOpen(false)}
                className="px-5 py-2.5 rounded-xl font-medium transition-all duration-300"
                style={{
                  background: 'linear-gradient(135deg, #a855f7, #8b5cf6)',
                  color: '#ffffff',
                  boxShadow: '0 4px 20px rgba(168,85,247,0.40)',
                }}
              >
                Confirm
              </button>
            </div>
          </ModalGlass>
        </section>
      </div>
    </div>
  );
};

// Required imports
import React, { useState } from 'react';
import {
  X,
  Info,
  CheckCircle,
  AlertTriangle,
  AlertCircle,
  User,
  Settings,
  LogOut,
  ChevronDown,
} from 'lucide-react';

export { NotificationGlass, AvatarGlass, DropdownGlass, ModalGlass, GlassFixesDemo };
export default GlassFixesDemo;
